import{_ as o}from"./ValaxyMain.vue_vue_type_style_index_0_lang.D_5nax1_.js";import{d as F,a as y,u}from"./chunks/vue-router.80J7uNal.js";import{I as c,K as a,L as n,M as i,O as C,N as s,u as m,J as v,E as B}from"./framework.Cuf0Rsyl.js";import"./app.F0OiV0yn.js";import"./chunks/dayjs.CmykVbh7.js";import"./chunks/@vueuse/motion.N-okJJbu.js";import"./chunks/vue-i18n.GD6HvabZ.js";import"./chunks/pinia.BFce4F4E.js";import"./chunks/nprogress.CYlLHXHZ.js";import"./YunComment.vue_vue_type_style_index_0_lang.b8Y-kbiF.js";import"./index.C5okkQwF.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang.DOEY2dpp.js";import"./post.DmhvpNS7.js";const b=F("/posts/sophgo-runtime-setup",async k=>JSON.parse('{"title":"算能边缘计算设备开发环境的搭建指北","description":"","frontmatter":{"title":"算能边缘计算设备开发环境的搭建指北","categories":"嵌入式","tags":["模型部署","嵌入式","深度学习"],"date":"2025-04-25 23:38:15 +0800","updated":"2025-04-30 20:00:00 +0800"},"headers":[],"relativePath":"pages/posts/sophgo-runtime-setup.md","lastUpdated":1755511470000}'),{lazy:(k,e)=>k.name===e.name}),W={__name:"sophgo-runtime-setup",setup(k,{expose:e}){var d;const{data:p}=b(),E=u(),r=y(),h=Object.assign(r.meta.frontmatter||{},((d=p.value)==null?void 0:d.frontmatter)||{});return r.meta.frontmatter=h,E.currentRoute.value.data=p.value,B("valaxy:frontmatter",h),globalThis.$frontmatter=h,e({frontmatter:{title:"算能边缘计算设备开发环境的搭建指北",categories:"嵌入式",tags:["模型部署","嵌入式","深度学习"],date:"2025-04-25 23:38:15 +0800",updated:"2025-04-30 20:00:00 +0800"}}),(t,l)=>{const g=o;return v(),c(g,{frontmatter:m(h)},{"main-content-md":a(()=>[l[0]||(l[0]=i("p",null,[i("a",{href:"https://www.sophgo.com/about-us/index.html",target:"_blank",rel:"noreferrer"},"算能（Sophgo）"),s("是国内开发边缘计算处理器比较著名的公司")],-1)),l[1]||(l[1]=i("p",null,[s("参加的一次竞赛，在使用其"),i("code",null,"cv181x"),s("处理器部署深度学习模型时，因为开发环境"),i("a",{href:"https://github.com/sophgo/cviruntime",target:"_blank",rel:"noreferrer"},[i("code",null,"cviruntime")]),s("的官方文档不是很完整，所以在开发环境的搭建上折腾了一小段时间，随后便写下此文记录我个人的解决方案，以供新手查阅")],-1)),C(" more "),l[2]||(l[2]=i("h2",{id:"安装wsl2",tabindex:"-1"},[s("安装WSL2 "),i("a",{class:"header-anchor",href:"#安装wsl2","aria-label":'Permalink to "安装WSL2"'},"​")],-1)),l[3]||(l[3]=i("div",{class:"tip custom-block"},[i("p",{class:"custom-block-title"},[i("span",{lang:"en"},"TIP"),i("span",{lang:"zh-CN"},"提示")]),i("p",null,"对于在Windows 11上已经安装了VMware Workstation Pro虚拟机以及搭建好了Linux开发环境的读者，可以跳过该章节")],-1)),l[4]||(l[4]=i("p",null,[s("应用开发使用C++和"),i("code",null,"cviruntime"),s("、"),i("code",null,"OpenCV"),s("进行"),i("strong",null,"交叉编译"),s("，因此需要配置一个适合用于交叉编译的环境，我推荐习惯Windows的读者使用"),i("a",{href:"https://learn.microsoft.com/zh-cn/windows/wsl/",target:"_blank",rel:"noreferrer"},[i("code",null,"Windows Subsystem for Linux")])],-1)),l[5]||(l[5]=i("h3",{id:"先决条件",tabindex:"-1"},[s("先决条件 "),i("a",{class:"header-anchor",href:"#先决条件","aria-label":'Permalink to "先决条件"'},"​")],-1)),l[6]||(l[6]=i("p",null,[s("请在"),i("code",null,"控制面板->程序->启用或关闭Windows功能"),s("里，启用"),i("code",null,"Hyper-V"),s("、"),i("code",null,"Virtual Machine Platform"),s("、"),i("code",null,"Windows虚拟机监控程序平台"),s("、"),i("code",null,"适用于Linux的Windows子系统"),s("，随后重启")],-1)),l[7]||(l[7]=i("h3",{id:"安装ubuntu-wsl2",tabindex:"-1"},[s("安装Ubuntu WSL2 "),i("a",{class:"header-anchor",href:"#安装ubuntu-wsl2","aria-label":'Permalink to "安装Ubuntu WSL2"'},"​")],-1)),l[8]||(l[8]=i("p",null,"在Windows 11及更新的系统上，使用如下指令安装WSL2：",-1)),l[9]||(l[9]=i("div",{class:"language-shell vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"shell"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"wsl"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --install"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -d"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," Ubuntu")])])]),i("button",{class:"collapse"})],-1)),l[10]||(l[10]=i("p",null,"安装完成后将会提示你创建用户以及输入用户登录密码",-1)),l[11]||(l[11]=i("div",{class:"tip custom-block"},[i("p",{class:"custom-block-title"},[i("span",{lang:"en"},"TIP"),i("span",{lang:"zh-CN"},"提示")]),i("p",null,[s("如果提示你升级WSL内核，请前往"),i("a",{href:"https://learn.microsoft.com/zh-cn/windows/wsl/install-manual#step-4---download-the-linux-kernel-update-package",target:"_blank",rel:"noreferrer"},"下载 Linux 内核更新包 - Microsoft Learn"),s("安装更新包并重新安装Ubuntu WSL")])],-1)),l[12]||(l[12]=i("h3",{id:"可选-将wsl移动到其它驱动器",tabindex:"-1"},[s("可选-将WSL移动到其它驱动器 "),i("a",{class:"header-anchor",href:"#可选-将wsl移动到其它驱动器","aria-label":'Permalink to "可选-将WSL移动到其它驱动器"'},"​")],-1)),l[13]||(l[13]=i("p",null,[s("WSL默认安装于C盘，如果你的C盘空间不够或者你有"),i("em",null,"极强的文件约束习惯"),s("，可以使用以下操作将已安装的WSL移动到其它驱动器（请将我的目录地址以及用户名等修改为你的实际值）：")],-1)),l[14]||(l[14]=i("p",null,"备份原有的WSL操作系统：",-1)),l[15]||(l[15]=i("div",{class:"language-shell vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"shell"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"wsl"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --export"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," Ubuntu"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," D:"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\A"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"rchives"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\u"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"buntu-wsl-initial.tar")])])]),i("button",{class:"collapse"})],-1)),l[16]||(l[16]=i("p",null,"卸载已安装的WSL：",-1)),l[17]||(l[17]=i("div",{class:"language-shell vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"shell"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"wsl"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --unregister"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," Ubuntu")])])]),i("button",{class:"collapse"})],-1)),l[18]||(l[18]=i("p",null,"将WSL安装到其它驱动器的新位置：",-1)),l[19]||(l[19]=i("div",{class:"language-shell vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"shell"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"wsl"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --import"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," Ubuntu"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," D:"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\V"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"irtualMachines"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\W"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"SL"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\U"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"buntu"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," D:"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\A"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"rchives"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\u"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"buntu-wsl-initial.tar")])])]),i("button",{class:"collapse"})],-1)),l[20]||(l[20]=i("p",null,"配置wsl默认用户：",-1)),l[21]||(l[21]=i("div",{class:"language-shell vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"shell"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"wsl"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --manage"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," Ubuntu"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --set-default-user"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," maxwell")])])]),i("button",{class:"collapse"})],-1)),l[22]||(l[22]=i("p",null,"（可选）配置wsl命令默认指代的实例，如果你同时安装了Docker Desktop，或者其他的WSL实例，请执行以下操作：",-1)),l[23]||(l[23]=i("div",{class:"language-shell vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"shell"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"wsl"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --set-default"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," Ubuntu")])])]),i("button",{class:"collapse"})],-1)),l[24]||(l[24]=i("h2",{id:"安装docker",tabindex:"-1"},[s("安装Docker "),i("a",{class:"header-anchor",href:"#安装docker","aria-label":'Permalink to "安装Docker"'},"​")],-1)),l[25]||(l[25]=i("p",null,"Docker基于Linux命名空间实现资源隔离，因此可以很方便地在一个操作系统内部署多个不同的应用环境而互相不受影响",-1)),l[26]||(l[26]=i("p",null,"在Windows上安装Docker即在Windows上的Linux环境里安装Docker，读者可以选择在VMware Workstation Pro的Linux虚拟机里安装，也可以选择直接使用Docker Desktop",-1)),l[27]||(l[27]=i("p",null,"Docker Desktop使用WSL2提供的Linux环境，因此若想使用Docker Desktop需要预先确保Hyper-V以及WSL2已经被正确安装",-1)),l[28]||(l[28]=i("p",null,[s("随后转到"),i("a",{href:"https://www.docker.com/products/docker-desktop/",target:"_blank",rel:"noreferrer"},"Docker Desktop的官方网站"),s("下载并安装Docker Desktop")],-1)),l[29]||(l[29]=i("figure",null,[i("img",{src:"https://lc-gluttony.s3.amazonaws.com/6Beck3SuJkGW/cxbt0vPW8MDJFwnSBJhXaCU4T4yARs1t/Snipaste_2025-04-24_19-10-58.png",alt:"安装好的Docker Desktop",loading:"lazy",decoding:"async"}),i("figcaption",null,"安装好的Docker Desktop")],-1)),l[30]||(l[30]=i("h2",{id:"配置vscode",tabindex:"-1"},[s("配置vscode "),i("a",{class:"header-anchor",href:"#配置vscode","aria-label":'Permalink to "配置vscode"'},"​")],-1)),l[31]||(l[31]=i("p",null,[s("建议使用Microsoft VS Code作为你的编辑器，如果没有，请前往"),i("a",{href:"https://code.visualstudio.com/",target:"_blank",rel:"noreferrer"},"官网"),s("下载并安装")],-1)),l[32]||(l[32]=i("h3",{id:"安装插件",tabindex:"-1"},[s("安装插件 "),i("a",{class:"header-anchor",href:"#安装插件","aria-label":'Permalink to "安装插件"'},"​")],-1)),l[33]||(l[33]=i("p",null,"对于C++开发建议使用clangd提供自动补全以及错误检查，为此你需要安装clangd插件。连接远程Linux系统需要使用SSH，因此你需要安装Remote Development捆绑插件",-1)),l[34]||(l[34]=i("h2",{id:"搭建基本linux开发环境",tabindex:"-1"},[s("搭建基本Linux开发环境 "),i("a",{class:"header-anchor",href:"#搭建基本linux开发环境","aria-label":'Permalink to "搭建基本Linux开发环境"'},"​")],-1)),l[35]||(l[35]=i("p",null,"使用以下指令连接上安装好的Ubuntu WSL：",-1)),l[36]||(l[36]=i("div",{class:"language-shell vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"shell"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"wsl"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -d"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," Ubuntu"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --cd"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ~")])])]),i("button",{class:"collapse"})],-1)),l[37]||(l[37]=i("figure",null,[i("img",{src:"https://lc-gluttony.s3.amazonaws.com/6Beck3SuJkGW/WJrG6XETXaqmgkCbvi8MFVP01xArogaW/Snipaste_2025-04-24_13-08-04.png",alt:"进入WSL示例",loading:"lazy",decoding:"async"}),i("figcaption",null,"进入WSL示例")],-1)),l[38]||(l[38]=i("h3",{id:"更换软件源",tabindex:"-1"},[s("更换软件源 "),i("a",{class:"header-anchor",href:"#更换软件源","aria-label":'Permalink to "更换软件源"'},"​")],-1)),l[39]||(l[39]=i("p",null,[s("在Ubuntu上，更换APT软件源，如果你想使用"),i("a",{href:"https://mirrors.tuna.tsinghua.edu.cn/",target:"_blank",rel:"noreferrer"},"清华大学开源软件镜像站"),s("，请转到"),i("a",{href:"https://mirrors.tuna.tsinghua.edu.cn/help/ubuntu/",target:"_blank",rel:"noreferrer"},"他们的帮助页面"),s("查看如何更换软件源")],-1)),l[40]||(l[40]=i("p",null,[s("补一张换源后的"),i("code",null,"/etc/apt/sources.list.d/ubuntu.sources")],-1)),l[41]||(l[41]=i("figure",null,[i("img",{src:"https://lc-gluttony.s3.amazonaws.com/6Beck3SuJkGW/xDLAi18VEoHk8NaPGc2t6aHeHnWFQEyv/Snipaste_2025-04-24_13-10-12.png",alt:"ubuntu.sources示例",loading:"lazy",decoding:"async"}),i("figcaption",null,"ubuntu.sources示例")],-1)),l[42]||(l[42]=i("h3",{id:"安装基本软件",tabindex:"-1"},[s("安装基本软件 "),i("a",{class:"header-anchor",href:"#安装基本软件","aria-label":'Permalink to "安装基本软件"'},"​")],-1)),l[43]||(l[43]=i("p",null,"使用以下命令安装基本环境：",-1)),l[44]||(l[44]=i("div",{class:"language-shell vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"shell"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"sudo"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," apt"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," install"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," gcc"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," g++"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," git"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," cmake"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ninja-build"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," python3"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," python3-pip"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," clangd")])])]),i("button",{class:"collapse"})],-1)),l[45]||(l[45]=i("h3",{id:"创建工具链目录",tabindex:"-1"},[s("创建工具链目录 "),i("a",{class:"header-anchor",href:"#创建工具链目录","aria-label":'Permalink to "创建工具链目录"'},"​")],-1)),l[46]||(l[46]=i("p",null,[s("可以在用户主目录下创建一个"),i("code",null,"sophgo"),s("目录用来存放"),i("code",null,"TPU SDK"),s("、"),i("code",null,"opencv-mobile"),s("以及"),i("code",null,"riscv host-tools")],-1)),l[47]||(l[47]=i("div",{class:"language-shell vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"shell"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"cd"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ~")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"mkdir"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," sophgo")])])]),i("button",{class:"collapse"})],-1)),l[48]||(l[48]=i("h3",{id:"安装交叉编译工具链",tabindex:"-1"},[s("安装交叉编译工具链 "),i("a",{class:"header-anchor",href:"#安装交叉编译工具链","aria-label":'Permalink to "安装交叉编译工具链"'},"​")],-1)),l[49]||(l[49]=i("p",null,"算能cv181x具有两个架构的处理器：ARM和Risc-V",-1)),l[50]||(l[50]=i("p",null,[i("code",null,"git clone"),s(" 算能Risc-V工具链的编译后二进制仓库：")],-1)),l[51]||(l[51]=i("div",{class:"language-shell vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"shell"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"git"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," clone"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," https://github.com/sophgo/host-tools.git")])])]),i("button",{class:"collapse"})],-1)),l[52]||(l[52]=i("div",{class:"warning custom-block"},[i("p",{class:"custom-block-title"},[i("span",{lang:"en"},"WARNING"),i("span",{lang:"zh-CN"},"注意")]),i("p",null,[s("对于Risc-V，"),i("strong",null,"此处"),s("我们要使用的是"),i("code",null,"musl libc"),s("而不是"),i("code",null,"glibc"),s("，有关二者区别，请参考：")]),i("p",null,[i("a",{href:"https://www.cnblogs.com/youxin/p/17818574.html",target:"_blank",rel:"noreferrer"},"1.glibc和musl libc的区别")]),i("p",null,[i("a",{href:"https://wiki.musl-libc.org/functional-differences-from-glibc.html",target:"_blank",rel:"noreferrer"},"2.Functional differences from glibc")])],-1)),l[53]||(l[53]=i("h3",{id:"配置环境变量",tabindex:"-1"},[s("配置环境变量 "),i("a",{class:"header-anchor",href:"#配置环境变量","aria-label":'Permalink to "配置环境变量"'},"​")],-1)),l[54]||(l[54]=i("p",null,[s("我推荐使用一些Linux发行版例如"),i("code",null,"openSUSE"),s("的做法，对于用户安装的应用，可以将其可执行文件链接到"),i("code",null,"~/bin"),s("目录下")],-1)),l[55]||(l[55]=i("div",{class:"language-shell vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"shell"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"mkdir"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ~/bin")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"ln"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -s"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ~/sophgo/host-tools/gcc/riscv64-linux-musl-x86_64/bin/riscv64-unknown-linux-musl-"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"*"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ~/bin")])])]),i("button",{class:"collapse"})],-1)),l[56]||(l[56]=i("p",null,"通过以下命令可以检验软软链接是否被正确设置",-1)),l[57]||(l[57]=i("div",{class:"language-shell vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"shell"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"ls"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -l"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ~/bin/riscv64-unknown-linux-musl-"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"*")])])]),i("button",{class:"collapse"})],-1)),l[58]||(l[58]=i("p",null,"如果正确地设置了软链接，那么会有下图所示的输出：",-1)),l[59]||(l[59]=i("figure",null,[i("img",{src:"https://lc-gluttony.s3.amazonaws.com/6Beck3SuJkGW/JuMjd1XwcHbmOKa9xPUnM6NTfRnEMI31/Snipaste_2025-04-29_10-48-05.png",alt:"使用ls -l检查软链接",loading:"lazy",decoding:"async"}),i("figcaption",null,"使用ls -l检查软链接")],-1)),l[60]||(l[60]=i("p",null,[s("设置软链接后，执行任意"),i("code",null,"~/bin/"),s("下的可执行文件就会实际上执行链接的目标文件")],-1)),l[61]||(l[61]=i("p",null,[s("随后将"),i("code",null,"~/bin"),s("目录添加进"),i("code",null,"PATH"),s("环境变量即可，编辑"),i("code",null,"~/.bashrc"),s("文件，在结尾处添加：")],-1)),l[62]||(l[62]=i("div",{class:"language-shell vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"shell"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"export"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," PATH"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=~"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"/bin/:$PATH")])])]),i("button",{class:"collapse"})],-1)),l[63]||(l[63]=i("p",null,[s("关闭终端并重新打开，此时已经应用了新的环境变量，不出意外，此时执行"),i("code",null,"riscv64-unknown-linux-musl-gcc -v"),s("会有输出：")],-1)),l[64]||(l[64]=i("figure",null,[i("img",{src:"https://lc-gluttony.s3.amazonaws.com/6Beck3SuJkGW/SVb1WUJFrdGHmoednWvgQkjuBlfvarcm/Snipaste_2025-04-29_10-54-17.png",alt:"riscv64-unknown-linux-musl-gcc的执行输出",loading:"lazy",decoding:"async"}),i("figcaption",null,"riscv64-unknown-linux-musl-gcc的执行输出")],-1)),l[65]||(l[65]=i("h2",{id:"搭建cviruntime环境",tabindex:"-1"},[s("搭建cviruntime环境 "),i("a",{class:"header-anchor",href:"#搭建cviruntime环境","aria-label":'Permalink to "搭建cviruntime环境"'},"​")],-1)),l[66]||(l[66]=i("p",null,[s("在算能设备上推理模型需要使用"),i("code",null,"cviruntime"),s("调用其TPU，起初我使用Sophgo维护的"),i("code",null,"cviruntime"),s("和"),i("code",null,"cvikernel"),s("，结果因为该项目文档极少且"),i("strong",null,"错误较多"),s("屡次编译失败，最后找到了milkv-duo维护的"),i("code",null,"sg200x-tpu-sdk"),s("，遂改为使用该SDK开发")],-1)),l[67]||(l[67]=i("h3",{id:"克隆tpu-sdk仓库",tabindex:"-1"},[s("克隆TPU-SDK仓库 "),i("a",{class:"header-anchor",href:"#克隆tpu-sdk仓库","aria-label":'Permalink to "克隆TPU-SDK仓库"'},"​")],-1)),l[68]||(l[68]=i("p",null,[s("切换到工具链目录"),i("code",null,"git clone"),s(" SDK仓库")],-1)),l[69]||(l[69]=i("div",{class:"language-shell vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"shell"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"git"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," clone"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," https://github.com/milkv-duo/tpu-sdk-sg200x.git"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," tpu-sdk")])])]),i("button",{class:"collapse"})],-1)),l[70]||(l[70]=i("h3",{id:"搭建模型开发环境",tabindex:"-1"},[s("搭建模型开发环境 "),i("a",{class:"header-anchor",href:"#搭建模型开发环境","aria-label":'Permalink to "搭建模型开发环境"'},"​")],-1)),l[71]||(l[71]=i("p",null,"安装PyTorch、Jetbrains PyCharm，此处略过",-1)),l[72]||(l[72]=i("h3",{id:"搭建模型转换环境",tabindex:"-1"},[s("搭建模型转换环境 "),i("a",{class:"header-anchor",href:"#搭建模型转换环境","aria-label":'Permalink to "搭建模型转换环境"'},"​")],-1)),l[73]||(l[73]=i("p",null,[s("在Docker Desktop里拉取"),i("code",null,"sophgo/tpuc_dev:latest"),s("镜像")],-1)),l[74]||(l[74]=i("p",null,"打开powershell使用下述命令启动容器：",-1)),l[75]||(l[75]=i("div",{class:"language-shell vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"shell"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," docker"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," run"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --name"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," tpuc_dev"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -v"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /workspace"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -it"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," sophgo/tpuc_dev:latest")])])]),i("button",{class:"collapse"})],-1)),l[76]||(l[76]=i("div",{class:"warning custom-block"},[i("p",{class:"custom-block-title"},[i("span",{lang:"en"},"WARNING"),i("span",{lang:"zh-CN"},"注意")]),i("p",null,[s("milkv-duo的文档启动时具有一个参数"),i("code",null,"--privileged"),s("，因为处于特权模式下的容器root用户具有与宿主机root用户相同的权限，我建议去掉该参数以保证安全性，关于利用Docker特权模式进行容器逃逸，请见"),i("a",{href:"https://www.isisy.com/1510.html",target:"_blank",rel:"noreferrer"},"记一次Docker下的Privileged特权模式容器逃逸")])],-1)),l[77]||(l[77]=i("p",null,"对于已经启动的容器，可以登录上去：",-1)),l[78]||(l[78]=i("div",{class:"language-shell vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"shell"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," exec"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -it"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," tpuc_dev"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /bin/bash")])])]),i("button",{class:"collapse"})],-1)),l[79]||(l[79]=i("p",null,[s("在工作目录"),i("code",null,"git clone"),s(" 转换工具仓库")],-1)),l[80]||(l[80]=i("div",{class:"language-shell vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"shell"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"git"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," clone"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," https://github.com/milkv-duo/tpu-mlir.git")])])]),i("button",{class:"collapse"})],-1)),l[81]||(l[81]=i("h3",{id:"搭建opencv-mobile开发环境",tabindex:"-1"},[s("搭建opencv-mobile开发环境 "),i("a",{class:"header-anchor",href:"#搭建opencv-mobile开发环境","aria-label":'Permalink to "搭建opencv-mobile开发环境"'},"​")],-1)),l[82]||(l[82]=i("p",null,[s("Milkv-duo为开发板适配了"),i("code",null,"opencv-mobile"),s("，其与"),i("code",null,"opencv"),s("相比更精简，且适配了一些外设，例如在使用"),i("code",null,"CAM-GC2083"),s("时，如果使用"),i("code",null,"opencv-mobile"),s("直接调用摄像头，那么此时就会更方便")],-1)),l[83]||(l[83]=i("p",null,"安装方法很简单，在工具链目录下载并解压缩最新的发行版即可：",-1)),l[84]||(l[84]=i("div",{class:"language-shell vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"shell"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"cd"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," sophgo")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"wget"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," https://github.com/nihui/opencv-mobile/releases/latest/download/opencv-mobile-4.11.0-milkv-duo.zip")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"unzip"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," opencv-mobile-4.11.0-milkv-duo.zip")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"mv"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," opencv-mobile-4.11.0-milkv-duo/"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," opencv-mobile")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"rm"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," opencv-mobile-4.11.0-milkv-duo.zip")])])]),i("button",{class:"collapse"})],-1)),l[85]||(l[85]=i("div",{class:"tip custom-block"},[i("p",{class:"custom-block-title"},[i("span",{lang:"en"},"TIP"),i("span",{lang:"zh-CN"},"提示")]),i("p",null,"如果提示找不到命令unzip，使用包管理器安装")],-1)),l[86]||(l[86]=i("h2",{id:"测试环境",tabindex:"-1"},[s("测试环境 "),i("a",{class:"header-anchor",href:"#测试环境","aria-label":'Permalink to "测试环境"'},"​")],-1)),l[87]||(l[87]=i("p",null,[s("我们将在设备上部署"),i("a",{href:"https://ai.meta.com/research/",target:"_blank",rel:"noreferrer"},"Facebook Research"),s("的"),i("a",{href:"https://arxiv.org/pdf/2304.07193",target:"_blank",rel:"noreferrer"},[i("code",null,"DinoV2特征提取器")]),s("测试环境搭建是否正确")],-1)),l[88]||(l[88]=i("h3",{id:"获取onnx模型",tabindex:"-1"},[s("获取onnx模型 "),i("a",{class:"header-anchor",href:"#获取onnx模型","aria-label":'Permalink to "获取onnx模型"'},"​")],-1)),l[89]||(l[89]=i("div",{class:"warning custom-block"},[i("p",{class:"custom-block-title"},[i("span",{lang:"en"},"WARNING"),i("span",{lang:"zh-CN"},"注意")]),i("p",null,[s("这篇博客的"),i("a",{href:"https://github.com/Katyusha0x26d/blog/commit/7f984a3521e7b4759b62b87ef59bb485bc2c9ec2",target:"_blank",rel:"noreferrer"},"之前某一个版本（2025.4.25 23:38，Commit:7f984a3）"),s("里我直接使用"),i("code",null,"DinoV2"),s("进行"),i("code",null,"ImageNet"),s("预测，这实际上是不对的，因为"),i("code",null,"DinoV2"),s("只是一个特征提取器，不是一个分类器，如果读者想要对图像进行分类，应该在"),i("code",null,"DinoV2"),s("骨干网络后增加一个分类头，而不是直接使用骨干网络进行分类")]),i("p",null,"在读者目前看到的文章版本里，这个错误已经被修复")],-1)),l[90]||(l[90]=i("p",null,"通过torch加载位于TorchHub的预训练模型，查看模型的详细信息并导出为onnx格式",-1)),l[91]||(l[91]=i("div",{class:"language-python vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"python"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," torch")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," torchinfo")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"dinov2_vits14 "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," torch.hub.load("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'facebookresearch/dinov2'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'dinov2_vits14'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"pretrained"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"True"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"torchinfo.summary(dinov2_vits14, ("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"3"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"448"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"448"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"))")])])]),i("button",{class:"collapse"})],-1)),l[92]||(l[92]=i("div",{class:"language-output vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"output"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",null,"==========================================================================================")]),s(`
`),i("span",{class:"line"},[i("span",null,"Layer (type:depth-idx)                   Output Shape              Param #")]),s(`
`),i("span",{class:"line"},[i("span",null,"==========================================================================================")]),s(`
`),i("span",{class:"line"},[i("span",null,"DinoVisionTransformer                    [1, 384]                  526,848")]),s(`
`),i("span",{class:"line"},[i("span",null,"├─PatchEmbed: 1-1                        [1, 1024, 384]            226,176")]),s(`
`),i("span",{class:"line"},[i("span",null,"├─ModuleList: 1-2                        --                        21,302,784")]),s(`
`),i("span",{class:"line"},[i("span",null,"├─LayerNorm: 1-3                         [1, 1025, 384]            768")]),s(`
`),i("span",{class:"line"},[i("span",null,"├─Identity: 1-4                          [1, 384]                  --")]),s(`
`),i("span",{class:"line"},[i("span",null,"==========================================================================================")]),s(`
`),i("span",{class:"line"},[i("span",null,"Total params: 22,056,576")]),s(`
`),i("span",{class:"line"},[i("span",null,"Trainable params: 22,056,576")]),s(`
`),i("span",{class:"line"},[i("span",null,"Non-trainable params: 0")]),s(`
`),i("span",{class:"line"},[i("span",null,"Total mult-adds (Units.MEGABYTES): 252.90")]),s(`
`),i("span",{class:"line"},[i("span",null,"==========================================================================================")]),s(`
`),i("span",{class:"line"},[i("span",null,"Input size (MB): 2.41")]),s(`
`),i("span",{class:"line"},[i("span",null,"Forward/backward pass size (MB): 497.51")]),s(`
`),i("span",{class:"line"},[i("span",null,"Params size (MB): 86.12")]),s(`
`),i("span",{class:"line"},[i("span",null,"Estimated Total Size (MB): 586.03")]),s(`
`),i("span",{class:"line"},[i("span",null,"==========================================================================================")])])]),i("button",{class:"collapse"})],-1)),l[93]||(l[93]=i("div",{class:"danger custom-block"},[i("p",{class:"custom-block-title"},[i("span",{lang:"en"},"DANGER"),i("span",{lang:"zh-CN"},"警告")]),i("p",null,[s("如果仅仅将上述获得的模型导出为onnx格式，那么由于模型"),i("code",null,"forward"),s("函数具有额外的除了张量以外的参数，会导致后续处理onnx模型时存在问题，因此我们需要对原有模型进行包装")])],-1)),l[94]||(l[94]=i("div",{class:"language-python vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"python"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," torch")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," torch.nn "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"as"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," nn")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," torch.nn.functional "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"as"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," F")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"class"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," WrappedModel"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"nn"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Module"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"):")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    def"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," __init__"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(self, model):")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        super"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"__init__"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        self"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".model "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," model")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    def"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," forward"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(self, x):")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," F.softmax("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"self"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".model(x), "),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"dim"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"test_inputs "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," torch.randn("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"3"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"448"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"448"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"model "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," WrappedModel(dinov2_vits14)")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"torch.onnx.export(model, test_inputs, "),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"dynamo"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"False"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"f"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'dinov2_vits14.onnx'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"external_data"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"False"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")])])]),i("button",{class:"collapse"})],-1)),l[95]||(l[95]=i("p",null,[s("导出后onnx模型即为"),i("code",null,"dinov2_vits14.onnx")],-1)),l[96]||(l[96]=i("div",{class:"tip custom-block"},[i("p",{class:"custom-block-title"},[i("span",{lang:"en"},"TIP"),i("span",{lang:"zh-CN"},"提示")]),i("p",null,[s("如果提示torch缺失依赖库"),i("code",null,"onnx"),s("、"),i("code",null,"onnxruntime"),s("，安装即可")])],-1)),l[97]||(l[97]=i("div",{class:"tip custom-block"},[i("p",{class:"custom-block-title"},[i("span",{lang:"en"},"TIP"),i("span",{lang:"zh-CN"},"提示")]),i("p",null,[s("如果在安装onnx时，安装失败，出现子命令执行错误，以及cmake的运行错误提示，这可能是因为你的Python版本过高，onnx暂时没有为你的Python版本发布的二进制已编译的发行版，因此onnx在安装时会尝试从源码开始构建，那么此时如果你缺失了"),i("code",null,"ProtoBuf"),s("等依赖库，就会编译错误")]),i("p",null,[s("最为简单的解决方案是将Python降级一个版本，例如在我写这篇文章时，是2025年四月，我的环境使用的是"),i("code",null,"Python 3.13.3"),s("，而onnx最高只有"),i("code",null,"Python 3.12"),s("的已编译的发行版，此时就出现了这个错误，将Python降级为3.12.10即可解决该错误")])],-1)),l[98]||(l[98]=i("div",{class:"tip custom-block"},[i("p",{class:"custom-block-title"},[i("span",{lang:"en"},"TIP"),i("span",{lang:"zh-CN"},"提示")]),i("p",null,[s("如果你在安装onnx时，又出现了"),i("code",null,"文件名或扩展名太长"),s("错误，这是因为Windows系统对于文件路径最长限制在260个字符，这可以在Windows 10/11上通过修改注册表键"),i("code",null,"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\FileSystem\\LongPathsEnabled"),s("，将键值设置为1解决，具体请参考"),i("a",{href:"https://learn.microsoft.com/zh-cn/windows/win32/fileio/maximum-file-path-limitation?tabs=registry",target:"_blank",rel:"noreferrer"},"最大路径长度限制-Microsoft文档")])],-1)),l[99]||(l[99]=i("h3",{id:"将onnx模型转换为cvimodel",tabindex:"-1"},[s("将onnx模型转换为cvimodel "),i("a",{class:"header-anchor",href:"#将onnx模型转换为cvimodel","aria-label":'Permalink to "将onnx模型转换为cvimodel"'},"​")],-1)),l[100]||(l[100]=i("p",null,"进入转换工具的Docker环境，设置环境变量",-1)),l[101]||(l[101]=i("div",{class:"language-shell vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"shell"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"source"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," tpu-mlir/envsetup.sh")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"mkdir"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," dinov2"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," && "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"cd"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," dinov2")])])]),i("button",{class:"collapse"})],-1)),l[102]||(l[102]=i("p",null,[s("获取一部分图片用于生成校准数据，读者可以自行按照部署环境情况获取图片，也可以使用现有数据集，例如"),i("code",null,"ImageNet-1k"),s("等")],-1)),l[103]||(l[103]=i("p",null,"将onnx模型上传到Docker容器",-1)),l[104]||(l[104]=i("div",{class:"language-shell vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"shell"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," cp"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," dinov2_vits14.onnx"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," tpuc_dev:/workspace/dinov2/dinov2_vits14.onnx")])])]),i("button",{class:"collapse"})],-1)),l[105]||(l[105]=i("p",null,[s("利用"),i("code",null,"model_transform.py"),s("将模型转换为"),i("code",null,"mlir"),s("格式")],-1)),l[106]||(l[106]=i("div",{class:"language-shell vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"shell"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"model_transform.py"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"--model_name "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"dinov2_vits14"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"--model_def "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"dinov2_vits14.onnx"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"--input_shapes [[1,3,448,448]] "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"--pixel_format"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "rgb"'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"--mean "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"123.675,116.28,103.53"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"--scale "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"0.0171,0.0175,0.0174"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"--mlir "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"dinov2_vits14.mlir")])])]),i("button",{class:"collapse"})],-1)),l[107]||(l[107]=i("p",null,[s("使用"),i("code",null,"run_calibration.py"),s("生成校准表")],-1)),l[108]||(l[108]=i("div",{class:"language-shell vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"shell"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"run_calibration.py"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," dinov2_vits14.mlir"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"--dataset "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"imagenet"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"--input_num "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"100"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"-o "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"dinov2_vits14_calib_table")])])]),i("button",{class:"collapse"})],-1)),l[109]||(l[109]=i("p",null,[s("将MLIR量化成INT8非对称cvimodel，并添加"),i("code",null,"--fuse_preprocess"),s("选项将预处理阶段集成在模型内部：")],-1)),l[110]||(l[110]=i("div",{class:"language-shell vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"shell"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"model_deploy.py"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"--mlir "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"dinov2_vits14.mlir"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"--asymmetric "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"--calibration_table "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"dinov2_vits14_calib_table"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"--chip "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"cv181x"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"--fuse_preprocess "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"--quantize "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"INT8"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," \\")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"--model "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"dinov2_vits14.cvimodel")])])]),i("button",{class:"collapse"})],-1)),l[111]||(l[111]=i("p",null,[s("完成转换后，使用"),i("code",null,"model_tool"),s("查看cvimodel信息")],-1)),l[112]||(l[112]=i("div",{class:"language-shell vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"shell"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"model_tool")])])]),i("button",{class:"collapse"})],-1)),l[113]||(l[113]=i("h3",{id:"编写cvimodel推理程序",tabindex:"-1"},[s("编写cvimodel推理程序 "),i("a",{class:"header-anchor",href:"#编写cvimodel推理程序","aria-label":'Permalink to "编写cvimodel推理程序"'},"​")],-1)),l[114]||(l[114]=i("p",null,"在之前安装的Ubuntu WSL上创建项目文件夹，配置clangd插件，配置项目",-1)),l[115]||(l[115]=i("div",{class:"language-shell vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"shell"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"mkdir"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," guidance"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," && "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"cd"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," guidance")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"mkdir"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," build")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"mkdir"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," .vscode"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," && "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"touch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," .vscode/settings.json")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"touch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," CMakeLists.txt")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"touch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," main.cpp")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"touch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," .clangd")])])]),i("button",{class:"collapse"})],-1)),l[116]||(l[116]=i("p",null,[s("编辑vscode的工作区插件配置文件"),i("code",null,".vscode/settings.json"),s("：")],-1)),l[117]||(l[117]=i("div",{class:"language-json vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"json"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},'    "clangd.arguments"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": [")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'        "--log=verbose"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'        "--background-index"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'        "--compile-commands-dir=build"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'        "-j=12"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'        "--clang-tidy"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'        "--all-scopes-completion"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'        "--header-insertion=never"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'        "--completion-style=detailed"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'        "--function-arg-placeholders"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'        "--pch-storage=memory"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'        "--fallback-style=LLVM"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'        "--suggest-missing-includes"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    ]")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"collapse"})],-1)),l[118]||(l[118]=i("p",null,[s("编辑clangd配置文件"),i("code",null,".clangd"),s("以移除march和mcpu选项，防止因为clangd内置的引擎不支持这些选项造成错误误报")],-1)),l[119]||(l[119]=i("div",{class:"language-yaml vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"yaml"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"CompileFlags"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    Remove"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        - "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"-march=*"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        - "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"-mcpu=*"')])])]),i("button",{class:"collapse"})],-1)),l[120]||(l[120]=i("p",null,[s("编辑项目配置"),i("code",null,"CMakeLists.txt")],-1)),l[121]||(l[121]=i("div",{class:"language-cmake vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"cmake"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"cmake_minimum_required"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"VERSION"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," 3.25)")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"set"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(SOPHGO_TOOLCHAIN_PATH /home/maxwell/sophgo)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"set"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(TPU_SDK_PATH "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"${SOPHGO_TOOLCHAIN_PATH}"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"/tpu-sdk)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"set"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(TOOLCHAIN riscv64-linux-musl-x86_64)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"set"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(CMAKE_TOOLCHAIN_FILE "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"${TPU_SDK_PATH}"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"/cmake/toolchain-"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"${TOOLCHAIN}"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".cmake)")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"project"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(guidance CXX)")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"set"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(CMAKE_EXPORT_COMPILE_COMMANDS "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ON"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"set"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(CMAKE_CXX_STANDARD 17)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"set"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(CMAKE_C_STANDARD 11)")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"set"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(HOST_TOOLS_PATH "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"${SOPHGO_TOOLCHAIN_PATH}"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"/host-tools)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"set"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(CMAKE_SYSROOT "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"${HOST_TOOLS_PATH}"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"/gcc/"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"${TOOLCHAIN}"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"/sysroot)")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"set"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(OPENCV_MOBILE_PATH "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"${SOPHGO_TOOLCHAIN_PATH}"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"/opencv-mobile)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"set"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(OpenCV_DIR "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"${OPENCV_MOBILE_PATH}"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"/lib/cmake/opencv4)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"find_package"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(OpenCV REQUIRED)")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"set"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(FLATBUFFERS_PATH "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"${TPU_SDK_PATH}"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"/flatbuffers)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"set"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Flatbuffers_DIR "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"${FLATBUFFERS_PATH}"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"/lib/cmake/flatbuffers)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"find_package"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Flatbuffers REQUIRED)")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"include_directories"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"${TPU_SDK_PATH}"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"/include)")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"add_executable"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(guidance")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    main.cpp")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"link_libraries"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"${TPU_SDK_PATH}"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"/lib)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"file"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(GLOB CVI_LIBS "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"${TPU_SDK_PATH}"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"/lib/libcvi*.so)")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"target_link_libraries"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(guidance")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    ${OpenCV_LIBS}")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    ${CVI_LIBS}")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")])])]),i("button",{class:"collapse"})],-1)),l[122]||(l[122]=i("p",null,[s("编辑C++程序"),i("code",null,"main.cpp")],-1)),l[123]||(l[123]=i("div",{class:"language-c++ vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"c++"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"#include"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," <cviruntime.h>")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"#include"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," <opencv2/opencv.hpp>")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"void"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," usage"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"char"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," *"),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"program_name"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    printf"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Usage: '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"%s"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," <model> <image>"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", program_name);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," main"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int"),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," argc"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"char"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," **"),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"argv"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (argc "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 3"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        usage"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(argv["),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," EXIT_FAILURE;")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    const"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," char"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," *"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"model_path "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," argv["),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"];")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    const"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," char"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," *"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"image_path "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," argv["),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"];")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // load model")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    CVI_MODEL_HANDLE model "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," nullptr"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    int"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," rc "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," CVI_NN_RegisterModel"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(model_path, "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"&"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"model);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (rc "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," CVI_RC_SUCCESS) {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        printf"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"CVI_NN_RegisterModel failed, err '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"%d\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", rc);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," EXIT_FAILURE;")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    CVI_TENSOR "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"*"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"input_tensors, "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"*"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"output_tensors;")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    int32_t"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," input_num, output_num;")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    CVI_NN_GetInputOutputTensors"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(model, "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"&"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"input_tensors, "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"&"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"input_num, "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"&"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"output_tensors, "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"&"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"output_num);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    CVI_TENSOR "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"*"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"input "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," CVI_NN_GetTensorByName"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(CVI_NN_DEFAULT_TENSOR, input_tensors, input_num);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    CVI_TENSOR "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"*"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"output "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," CVI_NN_GetTensorByName"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(CVI_NN_DEFAULT_TENSOR, output_tensors, output_num);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    float"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," input_qscale "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," CVI_NN_TensorQuantScale"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(input);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    printf"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"input qscale: '),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"%f\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", input_qscale);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    CVI_SHAPE input_shape "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," CVI_NN_TensorShape"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(input);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    int32_t"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," input_height "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," input_shape.dim["),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"];")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    int32_t"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," input_width "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," input_shape.dim["),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"3"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"];")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // Load input image")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    cv"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"::Mat bgr_image "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," cv"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"::"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"imread"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(image_path);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"bgr_image.data) {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        printf"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Could not open image'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," EXIT_FAILURE;")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    cv"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"::Mat image;")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    cv"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"::"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"resize"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(bgr_image, image, "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"cv"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"::"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Size"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(input_width, input_height));")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    cv"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"::"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"cvtColor"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(image, image, "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"cv"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"::COLOR_BGR2RGB);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    cv"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"::Size size "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," cv"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"::"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Size"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(input_width, input_height);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    cv"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"::Mat channels["),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"3"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"];")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    for"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," i "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"; i "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 3"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"; i"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"++"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        channels[i]  "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," cv"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"::"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Mat"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(input_width, input_height, CV_8SC1);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    cv"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"::"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"split"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(image, channels);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    for"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," i "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"; i "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 3"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"; i"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"++"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        channels[i]."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"convertTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(channels[i], CV_8SC1, input_qscale, "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // input image to model")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    int8_t"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," *"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"input_ptr "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int8_t"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," *"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"CVI_NN_TensorPtr"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(input);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    int"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," channel_size "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," input_height "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"*"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," input_width;")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    for"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," i "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"; i "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 3"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"; i"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"++"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        memcpy"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(input_ptr "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," i "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"*"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," channel_size, channels[i].data, channel_size);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // run inference")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    CVI_NN_Forward"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(model, input_tensors, input_num, output_tensors, output_num);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    printf"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"CVI_NN_Forward succeeded.'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // Output results")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    float"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," *"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"features "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"float"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," *"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"CVI_NN_TensorPtr"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(output);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    int"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," count "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," CVI_NN_TensorCount"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(output);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    printf"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"----------------'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    printf"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Image feature: "'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    for"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," i "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"; i "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," count; i"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"++"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        printf"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"%.3f"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", features[i]);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    printf"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    printf"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"----------------'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // cleanup")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    CVI_NN_CleanupModel"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(model);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    printf"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"CVI_NN_CleanupModel succeeded'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"collapse"})],-1)),l[124]||(l[124]=i("p",null,"随后执行cmake配置，可以使用vscode自动配置也可以进入build目录手动配置",-1)),l[125]||(l[125]=i("p",null,[s("随后打开"),i("code",null,"main.cpp"),s("可以看到clangd已经没有报错了，按住CTRL左键点击任何函数也能跳转到定义")],-1)),l[126]||(l[126]=i("p",null,[s("切换到"),i("code",null,"build"),s("目录，执行"),i("code",null,"ninja"),s("或者使用cmake插件自动编译也可以")],-1)),l[127]||(l[127]=i("p",null,[s("生成了"),i("code",null,"guidance"),s("这个可执行文件，我们使用SCP将其以及cvimodel模型、测试图片传输到设备上")],-1)),l[128]||(l[128]=i("div",{class:"language-shell vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"shell"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"scp"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -O"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," guidance"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," imagenet/ILSVRC2012_val_00000178.JPEG"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," dinov2_vits14.cvimodel"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," root@192.168.42.1:/root")])])]),i("button",{class:"collapse"})],-1)),l[129]||(l[129]=i("h3",{id:"cviruntime的测试结果",tabindex:"-1"},[s("cviruntime的测试结果 "),i("a",{class:"header-anchor",href:"#cviruntime的测试结果","aria-label":'Permalink to "cviruntime的测试结果"'},"​")],-1)),l[130]||(l[130]=i("p",null,"使用SSH登录设备，给编译后的二进制文件授予可执行权限：",-1)),l[131]||(l[131]=i("div",{class:"language-shell vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"shell"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"chmod"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," +x"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," guidance")])])]),i("button",{class:"collapse"})],-1)),l[132]||(l[132]=i("p",null,[s("执行程序获得结果，注意此处结果只是一个384长度的向量，因为我们使用的模型是一个特征提取器而不是分类器，对于常见的分类模型，分类器会将特征提取器的输出经过一个全连接层，随后经过 "),i("span",{class:"katex"},[i("span",{class:"katex-mathml"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("mi",null,"s"),i("mi",null,"o"),i("mi",null,"f"),i("mi",null,"t"),i("mi",null,"m"),i("mi",null,"a"),i("mi",null,"x")]),i("annotation",{encoding:"application/x-tex"},"softmax")])])]),i("span",{class:"katex-html","aria-hidden":"true"},[i("span",{class:"base"},[i("span",{class:"strut",style:{height:"0.8889em","vertical-align":"-0.1944em"}}),i("span",{class:"mord mathnormal"},"so"),i("span",{class:"mord mathnormal",style:{"margin-right":"0.10764em"}},"f"),i("span",{class:"mord mathnormal"},"t"),i("span",{class:"mord mathnormal"},"ma"),i("span",{class:"mord mathnormal"},"x")])])]),s(" 后才会得到"),i("code",null,"num_classes"),s(" 个类的具体概率")],-1)),l[133]||(l[133]=i("div",{class:"language-shell vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"shell"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"./guidance"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," dinov2_vits14.cvimodel"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ILSVRC2012_val_00000094.JPEG")])])]),i("button",{class:"collapse"})],-1)),l[134]||(l[134]=i("figure",null,[i("img",{src:"https://lc-gluttony.s3.amazonaws.com/6Beck3SuJkGW/vWYKcwiJrS8na1uYMrdCyXNpMRcfXQk1/Snipaste_2025-05-23_17-25-09.png",alt:"测试结果",loading:"lazy",decoding:"async"}),i("figcaption",null,"测试结果")],-1))]),"main-header":a(()=>[n(t.$slots,"main-header")]),"main-header-after":a(()=>[n(t.$slots,"main-header-after")]),"main-nav":a(()=>[n(t.$slots,"main-nav")]),"main-content-before":a(()=>[n(t.$slots,"main-content-before")]),"main-content":a(()=>[n(t.$slots,"main-content")]),"main-content-after":a(()=>[n(t.$slots,"main-content-after")]),"main-nav-before":a(()=>[n(t.$slots,"main-nav-before")]),"main-nav-after":a(()=>[n(t.$slots,"main-nav-after")]),comment:a(()=>[n(t.$slots,"comment")]),footer:a(()=>[n(t.$slots,"footer")]),aside:a(()=>[n(t.$slots,"aside")]),"aside-custom":a(()=>[n(t.$slots,"aside-custom")]),default:a(()=>[n(t.$slots,"default")]),_:3},8,["frontmatter"])}}};export{W as default,b as usePageData};
